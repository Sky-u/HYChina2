
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
</head>
<body>
<div class="center_r">
    <div class="video_title">
        <h1>车源发布</h1>
    </div>
    <div class="xgxx">
        <form id="addCarSource">
            <table width="98%" border="0" class="release-tab">
                <tr>
                    <td width="100" height="55"><font color="red">*</font>车辆类型：</td>
                    <td>
                        <select class="rele-select" name="type">
                            <option value="-1">请选择车辆类型</option>

                            <option value="1">不锈钢罐车</option>

                            <option value="2">铝罐车</option>

                            <option value="3">压力罐车</option>

                            <option value="4">铁罐车</option>

                            <option value="5">保温罐车</option>

                            <option value="6">平板车</option>

                            <option value="7">高栏车</option>

                            <option value="8">厢式车</option>

                        </select>
                    </td>
                </tr>
                <tr>
                    <td height="55"><font color="red">*</font>车源类型：</td>
                    <td>
                        <select class="rele-select" name="sourceType">
                            <option value="-1">请选择车源类型</option>


                            <option value="2">专程车</option>



                            <option value="3">回程车</option>


                        </select>
                    </td>
                </tr>
                <tr>
                    <td height="55"><font color="red">*</font>出&nbsp;发&nbsp;地：</td>
                    <td>
                        <select id="parent" name="departProvince" class="rele-select2"  onchange="genCity('departCity','departArea','rele-select2');">
                            <option value="-1">请选择省份</option>

                            <option value="110000">北京市</option>

                            <option value="120000">天津市</option>

                            <option value="130000">河北省</option>

                            <option value="140000">山西省</option>

                            <option value="150000">内蒙古自治区</option>

                            <option value="210000">辽宁省</option>

                            <option value="220000">吉林省</option>

                            <option value="230000">黑龙江省</option>

                            <option value="310000">上海市</option>

                            <option value="320000">江苏省</option>

                            <option value="330000">浙江省</option>

                            <option value="340000">安徽省</option>

                            <option value="350000">福建省</option>

                            <option value="360000">江西省</option>

                            <option value="370000">山东省</option>

                            <option value="410000">河南省</option>

                            <option value="420000">湖北省</option>

                            <option value="430000">湖南省</option>

                            <option value="440000">广东省</option>

                            <option value="450000">广西壮族自治区</option>

                            <option value="460000">海南省</option>

                            <option value="500000">重庆市</option>

                            <option value="510000">四川省</option>

                            <option value="520000">贵州省</option>

                            <option value="530000">云南省</option>

                            <option value="540000">西藏自治区</option>

                            <option value="610000">陕西省</option>

                            <option value="620000">甘肃省</option>

                            <option value="630000">青海省</option>

                            <option value="640000">宁夏回族自治区</option>

                            <option value="650000">新疆维吾尔自治区</option>

                            <option value="710000">台湾省</option>

                            <option value="810000">香港特别行政区</option>

                            <option value="820000">澳门特别行政区</option>

                        </select>
                        <span id="cspan">
	</span>
                        <span id="aspan">
	</span>
                    </td>
                </tr>
                <tr>
                    <td height="55">出发详细地址：</td>
                    <td><input name="departAddress" id="departAddress" type="text" class="rele-input" placeholder="(选填)建议输入出发详细地址"/><a href="javascript:value(0);" onclick="toDepartMap();"><img src="http://www.weiyun5.com/resources/mall/images/ad.png" width="24" height="23" class="ad" /></a></td>
                </tr>
                <tr>
                    <td height="55"><font color="red">*</font>到&nbsp;达&nbsp;地：</td>
                    <td>
                        <select id="parent1" name="arrvieProvince" class="rele-select2" onchange="genCity1('arrvieCity','arrvieArea','rele-select2');">
                            <option value="-1">请选择省份</option>

                            <option value="110000">北京市</option>

                            <option value="120000">天津市</option>

                            <option value="130000">河北省</option>

                            <option value="140000">山西省</option>

                            <option value="150000">内蒙古自治区</option>

                            <option value="210000">辽宁省</option>

                            <option value="220000">吉林省</option>

                            <option value="230000">黑龙江省</option>

                            <option value="310000">上海市</option>

                            <option value="320000">江苏省</option>

                            <option value="330000">浙江省</option>

                            <option value="340000">安徽省</option>

                            <option value="350000">福建省</option>

                            <option value="360000">江西省</option>

                            <option value="370000">山东省</option>

                            <option value="410000">河南省</option>

                            <option value="420000">湖北省</option>

                            <option value="430000">湖南省</option>

                            <option value="440000">广东省</option>

                            <option value="450000">广西壮族自治区</option>

                            <option value="460000">海南省</option>

                            <option value="500000">重庆市</option>

                            <option value="510000">四川省</option>

                            <option value="520000">贵州省</option>

                            <option value="530000">云南省</option>

                            <option value="540000">西藏自治区</option>

                            <option value="610000">陕西省</option>

                            <option value="620000">甘肃省</option>

                            <option value="630000">青海省</option>

                            <option value="640000">宁夏回族自治区</option>

                            <option value="650000">新疆维吾尔自治区</option>

                            <option value="710000">台湾省</option>

                            <option value="810000">香港特别行政区</option>

                            <option value="820000">澳门特别行政区</option>

                        </select>
                        <span id="cspan1">
	</span>
                        <span id="aspan1">
	</span>
                    </td>
                </tr>
                <tr>
                    <td height="55">到达详细地址：</td>
                    <td><input name="arrvieAddress" id="arrvieAddress" type="text" class="rele-input" placeholder="(选填)建议输入到达详细地址"/><a href="javascript:value(0);" onclick="toArrvieMap();"><img src="http://www.weiyun5.com/resources/mall/images/ad.png" width="24" height="23" class="ad" /></a></td>
                </tr>
                <tr>
                    <td height="55">联系人：</td>
                    <td><input name="people" type="text" class="rele-input" placeholder="(选填)建议输入联系人"/></td>
                </tr>
                <tr>
                    <td height="55">联系电话：</td>
                    <td><input name="mobile" type="text" class="rele-input" placeholder="(选填)建议输入联系电话"/></td>
                </tr>
                <tr>
                    <td height="55">车辆载重：</td>
                    <td><input name="load" type="text" class="rele-input" placeholder="(选填)单位（吨）"/></td>
                </tr>
                <tr>
                    <td height="55">车辆运费：</td>
                    <td><input name="freight" type="text" class="rele-input" placeholder="(选填)单位（元/吨）"/></td>
                </tr>
                <tr>
                    <td height="55"><font color="red">*</font>出发时间：</td>
                    <td><input class="Wdate rele-input" name="departTime" type="text" onClick="WdatePicker()"></td>
                </tr>
                <tr>
                    <td>备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：</td>
                    <td><textarea name="content" cols="" rows="" class="rele-textarea" placeholder="建议输入备注……"></textarea>
                    </td>
                </tr>
                <!--   <tr> -->
                <!--     <td height="250">地图定位：</td> -->
                <!--     <td> -->
                <!--     <a href="javascript:value(0);" onclick="toMap();"><img src="http://www.weiyun5.com/resources/mall/images/ad.png" width="24" height="23" class="ad" /></a> -->
                <!--     </td> -->
                <!--   </tr> -->
                <tr>
                    <td colspan="2"><p class="service-p"><span>注：</span>以上均为必选</p><a href="javascript:value(0);" onclick="addCarSource();" class="btn-facar right">立即发布</a></td>
                </tr>
            </table>
        </form>
    </div>
</div>
<script>
    function toMap(){
        window.open("http://www.weiyun5.com/map/coordinate");
    }
    function toDepartMap(){
        window.open("http://www.weiyun5.com/depart");
    }
    function toArrvieMap(){
        window.open("http://www.weiyun5.com/arrvie");
    }
    function addCarSource(){
        $.ajax({
            type:'post',
            url:'http://www.weiyun5.com/foreground/carSource/checkCarSource',
            data:$("#addCarSource").serialize(),
            success:function(data) {
                logining = false;
                if (data == "success") {
                    layer.alert("增加车源信息成功",function(index){layer.close(index);queryMember(10);});
                } else {
                    var error = [];
                    for (var key in data) {
                        error.push(data[key] + "\n");
                    }
                    layer.alert(error.join(""));
                }
            }
        });
    }
    /**
     * 异步加载全国地市
     */
    var cityName='';
    var areaName='';
    var className='';
    function genCity(one,two,three){
        cityName=one;
        areaName=two;
        className=three;
        var provinceid=byId("parent").value;
        if(provinceid!=-1){
            $.ajax({
                type:'post',
                url:'http://www.weiyun5.com/genCity',
                data:'provinceid='+provinceid,
                success:function(data) {
                    if (data["success"] == "success") {
                        var select="<select name='"+cityName+"' id='child_parent' class='"+className+"' onchange='genArea();'><option value='-1'>请选择市区</option>";
                        for(var i=0;i<data["city"].length;i++){
                            select=select+"<option value='"+data["city"][i]["cityid"]+"'>"+data["city"][i]["city"]+"</option>"
                        }
                        select=select+"</select>";
                        byId("cspan").innerHTML=select;
                        byId("aspan").innerHTML='';
                    } else {
                        var error = [];
                        for (var key in data) {
                            error.push(data[key] + "\n");
                        }
                        layer.alert(error.join(""));
                    }
                }
            });
        }else{
            byId("cspan").innerHTML='';
            byId("aspan").innerHTML='';
        }
    }
    function genArea(){
        var cityid=byId("child_parent").value;
        className=$("#child_parent").attr("class");
        if(cityid!=-1){
            $.ajax({
                type:'post',
                url:'http://www.weiyun5.com/genArea',
                data:'cityid='+cityid,
                success:function(data) {
                    if (data["success"] == "success") {
                        var select="<select name='"+areaName+"' class='"+className+"'><option value='-1'>请选择地区</option>";
                        for(var i=0;i<data["area"].length;i++){
                            select=select+"<option value='"+data["area"][i]["areaid"]+"'>"+data["area"][i]["area"]+"</option>"
                        }
                        select=select+"</select>";
                        byId("aspan").innerHTML=select;
                    } else {
                        var error = [];
                        for (var key in data) {
                            error.push(data[key] + "\n");
                        }
                        layer.alert(error.join(""));
                    }
                }
            });
        }else{
            byId("aspan").innerHTML='';
        }
    }
    /**
     * 异步加载全国地市
     */
    var cityName1='';
    var areaName1='';
    var className1='';
    function genCity1(one,two,three){
        cityName1=one;
        areaName1=two;
        className1=three;
        var provinceid=byId("parent1").value;
        if(provinceid!=-1){
            $.ajax({
                type:'post',
                url:'http://www.weiyun5.com/genCity',
                data:'provinceid='+provinceid,
                success:function(data) {
                    if (data["success"] == "success") {
                        var select="<select name='"+cityName1+"' id='child_parent1' class='"+className1+"' onchange='genArea1();'><option value='-1'>请选择市区</option>";
                        for(var i=0;i<data["city"].length;i++){
                            select=select+"<option value='"+data["city"][i]["cityid"]+"'>"+data["city"][i]["city"]+"</option>"
                        }
                        select=select+"</select>";
                        byId("cspan1").innerHTML=select;
                        byId("aspan1").innerHTML='';
                    } else {
                        var error = [];
                        for (var key in data) {
                            error.push(data[key] + "\n");
                        }
                        layer.alert(error.join(""));
                    }
                }
            });
        }else{
            byId("cspan1").innerHTML='';
            byId("aspan1").innerHTML='';
        }
    }
    function genArea1(){
        var cityid=byId("child_parent1").value;
        className=$("#child_parent1").attr("class");
        if(cityid!=-1){
            $.ajax({
                type:'post',
                url:'http://www.weiyun5.com/genArea',
                data:'cityid='+cityid,
                success:function(data) {
                    if (data["success"] == "success") {
                        var select="<select name='"+areaName1+"' class='"+className1+"'><option value='-1'>请选择地区</option>";
                        for(var i=0;i<data["area"].length;i++){
                            select=select+"<option value='"+data["area"][i]["areaid"]+"'>"+data["area"][i]["area"]+"</option>"
                        }
                        select=select+"</select>";
                        byId("aspan1").innerHTML=select;
                    } else {
                        var error = [];
                        for (var key in data) {
                            error.push(data[key] + "\n");
                        }
                        layer.alert(error.join(""));
                    }
                }
            });
        }else{
            byId("aspan1").innerHTML='';
        }
    }
    function showLogin()
    {//ajax实现实时扫描session
        $.ajax({
            type:'post',
            url:'http://www.weiyun5.com/genDepartOrArrvie',
            data:'',
            success:function(data) {
                if (data["success"] == "success") {
                    if(data["deaprtAddress"]!=''||data["deaprtAddress"]!=null){
                        byId("departAddress").value=data["deaprtAddress"];
                    }
                    if(data["arrvieAddress"]!=''||data["arrvieAddress"]!=null){
                        byId("arrvieAddress").value=data["arrvieAddress"];
                    }
// 	        		if(byId("departAddress").value!=''&&byId("arrvieAddress").value!=''){
// 	        			clearInterval(intervalID);
// 	        		}
                } else {
                    var error = [];
                    for (var key in data) {
                        error.push(data[key] + "\n");
                    }
                    layer.alert(error.join(""));
                }
            }
        });
    }
    var intervalID = setInterval("showLogin()","1000");
</script>
</body>
</html>